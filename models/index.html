<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <link rel="shortcut icon" href="../_static/logo.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Models - Mammoth</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/sphinx-toolbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_toolbox_installation.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Mammoth</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Mammoth</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">First steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/checkpoints.html">Load and save checkpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/distributed_training.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/parseval.html">Parseval</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../generated/models.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.coda_prompt_utils.html">Coda Prompt Utils</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Coda Prompt Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.coda_prompt_utils.model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.coda_prompt_utils.vit.html">vit</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.deprecated.html">Deprecated</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Deprecated</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.deprecated.joint.html">joint</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.dualprompt_utils.html">Dualprompt Utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Dualprompt Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.dualprompt_utils.attention.html">attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.dualprompt_utils.model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.dualprompt_utils.prompt.html">prompt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.dualprompt_utils.vision_transformer.html">vision_transformer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.l2p_utils.html">L2p Utils</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of L2p Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.l2p_utils.l2p_model.html">l2p_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.l2p_utils.prompt.html">prompt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.l2p_utils.vit_prompt.html">vit_prompt</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.slca_utils.html">Slca Utils</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Slca Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../generated/models.slca_utils.convs.html">Convs</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Convs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/models.slca_utils.convs.cifar_resnet.html">cifar_resnet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/models.slca_utils.convs.linears.html">linears</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/models.slca_utils.convs.resnet.html">resnet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/models.slca_utils.convs.vits.html">vits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.slca_utils.inc_net.html">inc_net</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.slca_utils.toolkit.html">toolkit</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.twf_utils.html">Twf Utils</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Twf Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.twf_utils.afd.html">afd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.twf_utils.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/models.utils.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.utils.continual_model.html">continual_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/models.utils.lider_model.html">lider_model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.agem.html">agem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.agem_r.html">agem_r</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.bic.html">bic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.ccic.html">ccic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.coda_prompt.html">coda_prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.der.html">der</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.derpp.html">derpp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.derpp_lider.html">derpp_lider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.dualprompt.html">dualprompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.er.html">er</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.er_ace.html">er_ace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.er_ace_lider.html">er_ace_lider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.ewc_on.html">ewc_on</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.fdr.html">fdr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.gdumb.html">gdumb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.gdumb_lider.html">gdumb_lider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.gem.html">gem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.gss.html">gss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.hal.html">hal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.icarl.html">icarl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.icarl_lider.html">icarl_lider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.joint_gcl.html">joint_gcl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.l2p.html">l2p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.lucir.html">lucir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.lwf.html">lwf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.lwf_mc.html">lwf_mc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.mer.html">mer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.pnn.html">pnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.rpc.html">rpc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.sgd.html">sgd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.si.html">si</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.twf.html">twf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.xder.html">xder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.xder_ce.html">xder_ce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/models.xder_rpc.html">xder_rpc</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../generated/datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/datasets.deprecated.html">Deprecated</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Deprecated</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.deprecated.old_mnist_360.html">old_mnist_360</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.imagenet_r_utils.html">Imagenet R Utils</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/datasets.transforms.html">Transforms</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Transforms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.transforms.denormalization.html">denormalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.transforms.permutation.html">permutation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.transforms.rotation.html">rotation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/datasets.utils.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.utils.continual_dataset.html">continual_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.utils.gcl_dataset.html">gcl_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/datasets.utils.validation.html">validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.mnist_360.html">mnist_360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.perm_mnist.html">perm_mnist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.rot_mnist.html">rot_mnist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_cifar10.html">seq_cifar10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_cifar100.html">seq_cifar100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_cifar100_224.html">seq_cifar100_224</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_cifar100_224_rs.html">seq_cifar100_224_rs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_cub200.html">seq_cub200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_imagenet_r.html">seq_imagenet_r</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_mnist.html">seq_mnist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_tinyimagenet.html">seq_tinyimagenet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/datasets.seq_tinyimagenet_r.html">seq_tinyimagenet_r</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../generated/backbone.html">Backbones</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Backbones</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../generated/backbone.utils.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/backbone.utils.modules.html">modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.EfficientNet.html">EfficientNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.MNISTMLP.html">MNISTMLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.MNISTMLP_PNN.html">MNISTMLP_PNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.ResNet18.html">ResNet18</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.ResNet18_PNN.html">ResNet18_PNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/backbone.ResNet50.html">ResNet50</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../generated/utils.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.args.html">args</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.augmentations.html">augmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.batch_norm.html">batch_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.best_args.html">best_args</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.buffer.html">buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.checkpoints.html">checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.conditional_bn.html">conditional_bn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.conf.html">conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.distributed.html">distributed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.gss_buffer.html">gss_buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.kornia_utils.html">kornia_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.loggers.html">loggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.magic.html">magic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.main.html">main</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.metrics.html">metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.mixup.html">mixup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.prompt_templates.html">prompt_templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.ring_buffer.html">ring_buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.schedulers.html">schedulers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.simclrloss.html">simclrloss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.status.html">status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.training.html">training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generated/utils.triplet.html">triplet</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="models">
<span id="module-models"></span><h1>Models<a class="headerlink" href="#models" title="Link to this heading">#</a></h1>
<p>A <strong>model</strong> is a class that contains a few requires methods and attributes to be used in the continual learning framework.
To be compatible with the auto-detection mechanism (the <strong>get_model</strong> function below), a model must:</p>
<ul class="simple">
<li><p>extend the base class <strong>ContinualModel</strong> in <a class="reference internal" href="../generated/models.utils.continual_model.html#module-continual-model"><span class="std std-ref">continual_model</span></a>, which implements most of the required methods, leaving to the user the definition of the <strong>observe</strong> method (see in <a class="reference internal" href="#training-and-testing"><span class="std std-ref">Training and testing</span></a>). In addition, the model must define the <strong>NAME</strong> and <strong>COMPATIBILITY</strong> attributes (see below).</p></li>
<li><p>be defined in a file named <strong>&lt;model_name&gt;.py</strong> and placed in the <strong>models</strong> folder.</p></li>
</ul>
<p>The model-specific hyper-parameters of the model can be set in the <strong>get_parser</strong> static method (see in <a class="reference internal" href="#model-parameters"><span class="std std-ref">Model parameters</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the file will be used to identify the model. For example, if the model is defined in a file named <strong>my_model.py</strong>, the name of the model will be <strong>my_model</strong> and will be called with the command line option <strong>–model my_model</strong>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Each file can contain <strong>only one</strong> model. If you want to define multiple models, you have to create multiple files.</p>
</div>
<section id="training-and-testing">
<h2>Training and testing<a class="headerlink" href="#training-and-testing" title="Link to this heading">#</a></h2>
<p>The <strong>observe</strong> method is the only method that <strong>must</strong> be implemented by the user. It is called at each training iteration and it is used to update the model parameters according to the current training batch. The method must have the following signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">not_aug_inputs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>

    <span class="c1"># Update the model parameters according to the current batch</span>
    <span class="o">...</span>

    <span class="c1"># Return the current loss value (as a float value)</span>
    <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre></div>
</div>
<p>The method receives as input the current training batch (i.e., <strong>inputs</strong> and <strong>labels</strong>), the original batch (i.e., <strong>not_aug_inputs</strong>) and (<em>optionally</em>) the current training epoch (i.e., <strong>epoch</strong>). The method must return the current loss value (as a float value).</p>
<section id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading">#</a></h3>
<p>The <strong>forward</strong> method is used to evaluate the model on the test set. By default, it is implemented in the base class <strong>ContinualModel</strong> and just calls the <strong>forward</strong> method of the backbone model. However, it can be overridden to implement a different evaluation method. The method must have the following signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>

    <span class="c1"># Compute the output of the model</span>
    <span class="o">...</span>

    <span class="c1"># Return the output of the model</span>
    <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
</section>
</section>
<section id="attributes-and-utility-methods">
<h2>Attributes and utility methods<a class="headerlink" href="#attributes-and-utility-methods" title="Link to this heading">#</a></h2>
<p>The base class <strong>ContinualModel</strong> (<a class="reference internal" href="../generated/models.utils.continual_model.html#module-continual-model"><span class="std std-ref">continual_model</span></a>) includes the <strong>NAME</strong> and <strong>COMPATIBILITY</strong> attributes, which are used to identify the model and to check its compatibility with the chosen <strong>setting</strong> (see <a class="reference internal" href="../generated/datasets.html#module-datasets"><span class="std std-ref">Datasets</span></a> for more details). The <strong>NAME</strong> attribute is a string that identifies the model, while the <strong>COMPATIBILITY</strong> attribute is a list of strings that identify the compatible settings. For example, the <strong>DER</strong> model (<a class="reference internal" href="../generated/models.der.html#module-der"><span class="std std-ref">der</span></a>) includes compatibility with <code class="docutils literal notranslate"><span class="pre">['class-il',</span> <span class="pre">'domain-il',</span> <span class="pre">'task-il',</span> <span class="pre">'general-continual']</span></code> settings, and thus is compatible with all the datasets included in the framework. However, as it includes no compatibility with the <code class="docutils literal notranslate"><span class="pre">'cssl'</span></code> setting, it cannot take advantage of unlabeled samples (available if <code class="docutils literal notranslate"><span class="pre">--label_perc</span></code> is set to a value between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
<section id="backbone-model">
<h3>Backbone model<a class="headerlink" href="#backbone-model" title="Link to this heading">#</a></h3>
<p>The <strong>ContinualModel</strong> loads the backbone model (i.e., the model used to compute the output of the model) during the initialization. By default, the backbone model is defined by the chosen <strong>dataset</strong> (see <a class="reference internal" href="../generated/datasets.html#module-datasets"><span class="std std-ref">Datasets</span></a> for more details). Once loaded, the backbone model can be accessed through the <strong>net</strong> attribute.</p>
</section>
<section id="begin-and-end-task">
<h3>Begin and end task<a class="headerlink" href="#begin-and-end-task" title="Link to this heading">#</a></h3>
<p>Besides the <strong>observe</strong> and <strong>forward</strong> methods, the <strong>ContinualModel</strong> provides the <strong>begin_task</strong> and <strong>end_task</strong> methods, which are called at the beginning and at the end of each task, respectively. These methods can be overridden to implement custom behavior. For example, the <strong>end_task</strong> method can be used to save the model parameters at the end of each task.</p>
</section>
<section id="automatic-attributes">
<h3>Automatic attributes<a class="headerlink" href="#automatic-attributes" title="Link to this heading">#</a></h3>
<p>The base class <strong>ContinualModel</strong> provides a few properties that are automatically set during the incremental training (see <a class="reference internal" href="../generated/models.utils.continual_model.html#module-models.utils.continual_model"><span class="std std-ref">continual_model</span></a> for more details). The most important attributes are:</p>
<div class="admonition-task-related-attributes admonition">
<p class="admonition-title">Task-related attributes:</p>
<ul class="simple">
<li><p><strong>current_task</strong>: the index of the current task (starting from 0). This attribute is automatically updated at the end of each task (<em>after</em> the <strong>end_task</strong>).</p></li>
<li><p><strong>n_classes_current_task</strong>: the number of classes in the current task.</p></li>
<li><p><strong>n_past_classes</strong>: the total number of classes seen so far (past).</p></li>
<li><p><strong>n_seen_classes</strong>: the total number of classes seen so far (past and current).</p></li>
<li><p><strong>n_classes</strong>: the total number of classes in the dataset (past, current, and remaining).</p></li>
<li><p><strong>n_tasks</strong>: the total number of tasks.</p></li>
<li><p><strong>task_iteration</strong>: the number of iterations performed during the current task. This attribute is automatically updated <em>after</em> each <strong>observe</strong> call and is reset at the beginning of each task (<em>before</em> the <strong>begin_task</strong>). Can be used to implement a virtual batch size (see <a class="reference internal" href="../generated/models.twf.html#module-twf"><span class="std std-ref">twf</span></a>).</p></li>
<li><p><strong>cpt</strong>: the <em>raw</em> amount of classes for each task. This could be either an integer (i.e., the number of classes for each task is the same) or a list of integers (i.e., the number of classes for each task is different).</p></li>
</ul>
</div>
<div class="admonition-transforms-and-dataset-related-attributes admonition">
<p class="admonition-title">Transforms and dataset-related Attributes</p>
<ul class="simple">
<li><p><strong>transform</strong>: the transform applied to the input data. This attribute is automatically set during the initialization of the model and is defined by the chosen <strong>dataset</strong> (see <a class="reference internal" href="../generated/datasets.html#module-datasets"><span class="std std-ref">Datasets</span></a> for more details).</p></li>
<li><p><strong>weak_transform</strong>: this function is used to apply a new transform to a <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html">torch.Tensor</a>. In most cases, this is implemented as a <a class="reference external" href="https://github.com/kornia/kornia">kornia</a> transform. However, if a transform is not supported by the <strong>to_kornia_transform</strong>, it is implemented as <a class="reference external" href="https://pillow.readthedocs.io/en/stable/">PIL</a>.</p></li>
<li><p><strong>normalization_transform</strong>: the transform used to normalize the input data. As for the <strong>weak_transform</strong>, this is implemented as a <a class="reference external" href="https://github.com/kornia/kornia">kornia</a> transform if possible, otherwise it is implemented as <a class="reference external" href="https://pillow.readthedocs.io/en/stable/">PIL</a>.</p></li>
</ul>
</div>
<div class="admonition-other-notable-attributes admonition">
<p class="admonition-title">Other notable attributes</p>
<ul class="simple">
<li><p><strong>device</strong>: the device used (e.g, <code class="docutils literal notranslate"><span class="pre">cpu</span></code> or <code class="docutils literal notranslate"><span class="pre">cuda:0</span></code>).</p></li>
<li><p><strong>net</strong>: the backbone model (see above).</p></li>
<li><p><strong>opt</strong>: the optimizer used to train the model.</p></li>
<li><p><strong>loss</strong>: the loss function, defined by the chosen <strong>dataset</strong> (see <a class="reference internal" href="../generated/datasets.html#module-datasets"><span class="std std-ref">Datasets</span></a> for more details).</p></li>
<li><p><strong>dataset</strong>: a reference to the chosen <strong>dataset</strong>, to ease the access to its attributes.</p></li>
<li><p><strong>args</strong>: the arguments passed to the framework.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The automatic conversion between <a class="reference external" href="https://pillow.readthedocs.io/en/stable/">PIL</a> and <a class="reference external" href="https://github.com/kornia/kornia">kornia</a> is handeled by the <strong>to_kornia_transform</strong> function in <a class="reference internal" href="../generated/utils.kornia_utils.html#module-utils.kornia_utils"><span class="std std-ref">kornia_utils</span></a>, which converts (<em>most</em>) PIL transforms to kornia transforms. However, not all the transforms are supported, and thus this function <em>may not be always available</em>. If you want to use a custom transform, you have to extend the <strong>to_kornia_transform</strong> function.</p>
</div>
</section>
<section id="model-parameters">
<h3>Model parameters<a class="headerlink" href="#model-parameters" title="Link to this heading">#</a></h3>
<p>The <strong>get_parser</strong> method is used to define the model-specific hyper-parameters. It is defined as a static method (see <a class="reference internal" href="../generated/models.utils.continual_model.html#module-continual-model"><span class="std std-ref">continual_model</span></a>) that returns a <a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser">argparse.ArgumentParser</a> object. This method is called during the initialization of the model and it is used to parse the command line arguments. The <strong>get_parser</strong> method must have the following signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>

    <span class="c1"># Create the parser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="s1">&#39;MyModel parameters&#39;</span><span class="p">)</span>

    <span class="c1"># Add the model-specific hyper-parameters</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--my_param&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;My parameter&#39;</span><span class="p">)</span>
    <span class="o">...</span>

    <span class="k">return</span> <span class="n">parser</span>
</pre></div>
</div>
<p>Once the model is selected with the command line option <strong>–model</strong>, the hyper-parameters are loaded and can be viewed with <code class="docutils literal notranslate"><span class="pre">--help</span></code>.</p>
</section>
<section id="other-utility-methods">
<h3>Other utility methods<a class="headerlink" href="#other-utility-methods" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>get_optimizer</strong>: returns the optimizer used to train the model.</p></li>
<li><p><strong>get_debug_iters</strong>: used if <code class="docutils literal notranslate"><span class="pre">--debug_mode</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, it returns the number of iterations to perform during each task. By default, it returns <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><dl>
<dt><strong>autolog_wandb</strong>: called after each observe, it relies on the <a class="reference internal" href="../generated/utils.magic.html#module-utils.magic"><span class="std std-ref">magic</span></a> module to log all the variables created in the <strong>observe</strong> that start with <em>loss</em> or <em>_wandb_</em>. This method can also be called manually to log custom variables by providing the <code class="docutils literal notranslate"><span class="pre">extra</span></code> parameter.</dt><dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is called only if <code class="docutils literal notranslate"><span class="pre">--debug_mode</span></code> is set to <code class="docutils literal notranslate"><span class="pre">0</span></code> (i.e, it is not called during the debug mode).</p>
</div>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="advanced-usage">
<h2>Advanced usage<a class="headerlink" href="#advanced-usage" title="Link to this heading">#</a></h2>
<p>The <strong>ContinualModel</strong> class relies on a few hooks to automatically update its internal attributes. These hooks are called before the <strong>begin_task</strong>, <strong>end_task</strong>, and <strong>observe</strong> methods (<strong>meta_begin_task</strong>, <strong>meta_end_task</strong>, and <strong>meta_observe</strong> respectively). If you want to implement a custom behavior, you can override these hooks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>meta_observe</strong> is responsible for removing the <em>unlabeled</em> samples (i.e., those with an associated label set to <code class="docutils literal notranslate"><span class="pre">-1</span></code>) from the batch if the model does not support the <code class="docutils literal notranslate"><span class="pre">--label_perc</span></code> parameter.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Pietro Buzzega, Matteo Boschini, Lorenzo Bonicelli, Aniello Panariello, Davide Abati, Angelo Porrello, Simone Calderara
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Models</a><ul>
<li><a class="reference internal" href="#training-and-testing">Training and testing</a><ul>
<li><a class="reference internal" href="#evaluation">Evaluation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#attributes-and-utility-methods">Attributes and utility methods</a><ul>
<li><a class="reference internal" href="#backbone-model">Backbone model</a></li>
<li><a class="reference internal" href="#begin-and-end-task">Begin and end task</a></li>
<li><a class="reference internal" href="#automatic-attributes">Automatic attributes</a></li>
<li><a class="reference internal" href="#model-parameters">Model parameters</a></li>
<li><a class="reference internal" href="#other-utility-methods">Other utility methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-usage">Advanced usage</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/sphinx_toolbox_installation.js"></script>
    </body>
</html>